

1. <span data-ttu-id="c7c1e-101">Navegue até [https://apps.dev.microsoft.com/](https://apps.dev.microsoft.com).</span><span class="sxs-lookup"><span data-stu-id="c7c1e-101">Navigate to [https://apps.dev.microsoft.com/](https://apps.dev.microsoft.com)</span></span>

1. <span data-ttu-id="c7c1e-102">Entre com as credenciais de ***administrador*** no locatário do Office 365.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-102">Sign-in with the admin credentials to your Office 365 tenancy. For example, MyName@contoso.onmicrosoft.com</span></span> <span data-ttu-id="c7c1e-103">Por exemplo, MyName@contoso.onmicrosoft.com</span><span class="sxs-lookup"><span data-stu-id="c7c1e-103">For example, MyName@contoso.onmicrosoft.com</span></span>

1. <span data-ttu-id="c7c1e-104">Clique em **Adicionar um aplicativo**.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-104">Click **Add an app**.</span></span>

1. <span data-ttu-id="c7c1e-105">Quando solicitado, insira **$ADD-IN-NAME$** como o nome do aplicativo e pressione **Criar aplicativo**.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-105">When prompted, use “Office-Add-in-ASPNET-SSO” as the app name, and then press Create application.</span></span>

1. <span data-ttu-id="c7c1e-p102">Quando a página de configuração do aplicativo abrir, copie o **Id do Aplicativo** e salve-o. Você o usará em um procedimento posterior.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-p102">When the configuration page for the app opens, copy the **Application Id** and save it. You'll use it in a later procedure.</span></span>

    > [!NOTE]
    > <span data-ttu-id="c7c1e-p103">Essa ID é o valor "audience" (público) quando outros aplicativos, como o aplicativo host do Office (por exemplo, PowerPoint, Word, Excel), buscam o acesso autorizado ao aplicativo. Também é a "ID do cliente" do aplicativo quando ela, por sua vez, busca o acesso autorizado ao Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-p103">This ID is the “audience” value when other applications, such as the Office host application (e.g., PowerPoint, Word, Excel), seek authorized access to the application. It is also the “client ID” of the application when it, in turn, seeks authorized access to Microsoft Graph.</span></span>

1. <span data-ttu-id="c7c1e-p104">Na seção **Segredos do Aplicativo**, pressione **Gerar Nova Senha**. Uma caixa de diálogo pop-up abrirá e uma nova senha (também chamada de "segredo do aplicativo") será mostrada. *Copie a senha imediatamente e salve-a com a ID do aplicativo.* Você precisará dela em um procedimento posterior. Feche a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-p104">In the **Application Secrets** section, press **Generate New Password**. A popup dialog opens with a new password (also called an “app secret”) displayed. *Copy the password immediately and save it with the application ID.* You'll need it in a later procedure. Then close the dialog.</span></span>

1. <span data-ttu-id="c7c1e-115">Na seção **Plataformas**, clique em **Adicionar plataforma**.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-115">In the **Platforms** section, click **Add Platform**.</span></span>

1. <span data-ttu-id="c7c1e-116">Na caixa de diálogo exibida, selecione **Web API**.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-116">In the dialog that opens, select **Web API**.</span></span>

1. <span data-ttu-id="c7c1e-117">A **URI da ID do aplicativo** foi gerada do formulário “api: // $ App ID GUID $”.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-117">An **Application ID URI** has been generated of the form “api://$App ID GUID$”.</span></span> <span data-ttu-id="c7c1e-118">Insira o **$FQDN-WITHOUT-PROTOCOL$** (com uma barra "/" anexada ao final) entre as barras duplas e o GUID.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-118">Insert the **$FQDN-WITHOUT-PROTOCOL$** (with a forward slash "/" appended to the end) between the double forward slashes and the GUID.</span></span> <span data-ttu-id="c7c1e-119">A ID inteira deve ter o formulário `api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$`; por exemplo `api://localhost:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7`.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-119">The entire ID should have the form `api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$`; for example `api://localhost:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7`.</span></span>

    > [!NOTE]
    > <span data-ttu-id="c7c1e-120">Se você receber um erro informando que o domínio já tem um dono, mas você é o proprietário, siga o procedimento em [Início rápido: adicionar um nome de domínio personalizado ao Active Directory do Azure](https://docs.microsoft.com/azure/active-directory/add-custom-domain) para registrá-lo e repita este passo.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-120">If you get an error saying that the domain is already owned, but you own it, follow the procedure at [Quickstart: Add a custom domain name to Azure Active Directory](https://docs.microsoft.com/azure/active-directory/add-custom-domain) to register it, and then repeat this step.</span></span> <span data-ttu-id="c7c1e-121">(Esse erro também pode ocorrer se você não estiver conectado com as credenciais de um administrador no locatário do Office 365.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-121">(This error can also occur if you are not signed in with credentials of an admin in the Office 365 tenancy.</span></span> <span data-ttu-id="c7c1e-122">Veja a etapa 2.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-122">See step 2.</span></span> <span data-ttu-id="c7c1e-123">Deve sair e entrar novamente com credenciais de administrador e repetir o processo da etapa 3.)</span><span class="sxs-lookup"><span data-stu-id="c7c1e-123">Sign out and sign in again with admin credentials and repeat the process from step 3.)</span></span>

    > [!NOTE]
    > <span data-ttu-id="c7c1e-124">A parte do domínio do nome do **Escopo** logo abaixo do **URI da ID do aplicativo** mudará automaticamente, com `/access_as_user` anexado ao final; por exemplo, `api://localhost:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7/access_as_user`.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-124">The domain part of the **Scope** name just below the **Application ID URI** will automatically change to match.</span></span>

1. <span data-ttu-id="c7c1e-125">Na seção **Aplicativos pré-autorizados**, você identifica os aplicativos que deseja autorizar para o aplicativo da Web do seu suplemento.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-125">In the **Pre-authorized applications** section, you identify the applications that you want to authorize to your add-in's web application.</span></span> <span data-ttu-id="c7c1e-126">Cada uma das seguintes IDs precisa ser pré-autorizada.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-126">Each of the following IDs needs to be pre-authorized.</span></span> <span data-ttu-id="c7c1e-127">Cada vez que você inserir uma, uma nova caixa de texto vazia aparece.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-127">Each time you enter one, a new empty textbox appears.</span></span> <span data-ttu-id="c7c1e-128">(Insira apenas o GUID.)</span><span class="sxs-lookup"><span data-stu-id="c7c1e-128">(Enter only the GUID.)</span></span>
    * <span data-ttu-id="c7c1e-129">`d3590ed6-52b3-4102-aeff-aad2292ab01c` (Microsoft Office)</span><span class="sxs-lookup"><span data-stu-id="c7c1e-129">`d3590ed6-52b3-4102-aeff-aad2292ab01c` (Microsoft Office)</span></span>
    * <span data-ttu-id="c7c1e-130">`57fb890c-0dab-4253-a5e0-7188c88b2bb4` (Office Online)</span><span class="sxs-lookup"><span data-stu-id="c7c1e-130">`57fb890c-0dab-4253-a5e0-7188c88b2bb4` (Office Online)</span></span>
    * <span data-ttu-id="c7c1e-131">`bc59ab01-8403-45c6-8796-ac3ef710b3e3` (Office Online)</span><span class="sxs-lookup"><span data-stu-id="c7c1e-131">`bc59ab01-8403-45c6-8796-ac3ef710b3e3` (Office Online)</span></span>

1. <span data-ttu-id="c7c1e-132">Abra o menu suspenso do **Escopo** ao lado de cada **ID do aplicativo** e marque a caixa para `api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$/access_as_user`.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-132">Open the **Scope** drop-down beside each **Application ID** and check the box for `api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$/access_as_user`.</span></span>

1. <span data-ttu-id="c7c1e-133">Próximo ao topo da seção **Plataformas**, clique em **Adicionar Plataforma** novamente e selecione **Web**.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-133">Near the top of the **Platforms** section, click **Add Platform** again and select **Web**.</span></span>

1. <span data-ttu-id="c7c1e-134">Na nova seção **Web** em **Plataformas**, insira o seguinte como um **URL de redirecionamento**: `https://$FQDN-WITHOUT-PROTOCOL$`.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-134">In the new **Web** section under **Platforms**, enter the following as a **Redirect URL**: `https://$FQDN-WITHOUT-PROTOCOL$`.</span></span>

1. <span data-ttu-id="c7c1e-p108">Role para baixo até a seção **Permissões do Microsoft Graph**, subseção **Permissões Delegadas**. Use o botão **Adicionar** para abrir a caixa de diálogo **Selecionar Permissões**.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-p108">Scroll down to the **Microsoft Graph Permissions** section, the **Delegated Permissions** subsection. Use the **Add** button to open a **Select Permissions** dialog.</span></span>

1. <span data-ttu-id="c7c1e-137">Na caixa de diálogo, marque as caixas para `profile` e quaisquer outras permissões do AAD e do Microsoft Graph que seu suplemento precise.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-137">In the dialog box, check the boxes for `profile` and any other AAD and Microsoft Graph permissions that your add-in needs.</span></span> <span data-ttu-id="c7c1e-138">Veja alguns exemplos:</span><span class="sxs-lookup"><span data-stu-id="c7c1e-138">The following are examples:</span></span>

    * <span data-ttu-id="c7c1e-139">Files.Read.All</span><span class="sxs-lookup"><span data-stu-id="c7c1e-139">Files.Read.All</span></span>
    * <span data-ttu-id="c7c1e-140">offline_access</span><span class="sxs-lookup"><span data-stu-id="c7c1e-140">offline_access</span></span>
    * <span data-ttu-id="c7c1e-141">openid</span><span class="sxs-lookup"><span data-stu-id="c7c1e-141">openid</span></span>
    * <span data-ttu-id="c7c1e-142">perfil</span><span class="sxs-lookup"><span data-stu-id="c7c1e-142">profile</span></span>

    > [!NOTE]
    > <span data-ttu-id="c7c1e-143">A permissão `User.Read` já pode estar listada por padrão.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-143">The `User.Read` permission may already be listed by default.</span></span> <span data-ttu-id="c7c1e-144">É uma boa prática não solicitar permissões que não sejam necessárias, portanto, recomendamos que você desmarque a caixa para essa permissão se o seu suplemento realmente não precisar dela.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-144">It is a good practice not to ask for permissions that are not needed, so we recommend that you uncheck the box for this permission.</span></span>

1. <span data-ttu-id="c7c1e-145">Na parte inferior do diálogo, clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-145">At the bottom of the dialog, click **OK**.</span></span>

1. <span data-ttu-id="c7c1e-146">Na parte inferior da página de registro, clique em **Salvar**.</span><span class="sxs-lookup"><span data-stu-id="c7c1e-146">At the bottom of the registration page, click **Save**.</span></span>
