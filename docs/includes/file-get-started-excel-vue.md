# <a name="build-an-excel-add-in-using-vue"></a><span data-ttu-id="53241-101">Criar um suplemento do Excel usando o Vue</span><span class="sxs-lookup"><span data-stu-id="53241-101">Build an Excel add-in using Vue</span></span>

<span data-ttu-id="53241-102">Neste artigo, voc? passar? pelo processo de criar um suplemento do Excel usando o Vue e a API JavaScript do Excel.</span><span class="sxs-lookup"><span data-stu-id="53241-102">In this article, you'll walk through the process of building an Excel add-in using Vue and the Excel JavaScript API.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="53241-103">Pr?-requisitos</span><span class="sxs-lookup"><span data-stu-id="53241-103">Prerequisites</span></span>

- <span data-ttu-id="53241-104">Instalar a [CLI do Vue](https://github.com/vuejs/vue-cli) globalmente.</span><span class="sxs-lookup"><span data-stu-id="53241-104">Install the [Vue CLI](https://github.com/vuejs/vue-cli) globally.</span></span>

    ```bash
    npm install -g vue-cli
    ```

- <span data-ttu-id="53241-105">Instale a ?ltima vers?o do [Yeoman](https://github.com/yeoman/yo) e o [gerador do Yeoman para Suplementos do Office](https://github.com/OfficeDev/generator-office) globalmente.</span><span class="sxs-lookup"><span data-stu-id="53241-105">Install the latest version of [Yeoman](https://github.com/yeoman/yo) and the [Yeoman generator for Office Add-ins](https://github.com/OfficeDev/generator-office) globally.</span></span>

    ```bash
    npm install -g yo generator-office
    ```

## <a name="generate-a-new-vue-app"></a><span data-ttu-id="53241-106">Gerar um novo aplicativo Vue</span><span class="sxs-lookup"><span data-stu-id="53241-106">Generate a new Vue app</span></span>

<span data-ttu-id="53241-107">Use a CLI do Vue para gerar um novo aplicativo Vue.</span><span class="sxs-lookup"><span data-stu-id="53241-107">Use the Vue CLI to generate a new Vue app.</span></span> <span data-ttu-id="53241-108">No terminal, execute o comando a seguir e responda aos prompts conforme descrito abaixo.</span><span class="sxs-lookup"><span data-stu-id="53241-108">From the terminal, run the following command and then answer the prompts as described below.</span></span>

```bash
vue init webpack my-add-in
```

<span data-ttu-id="53241-109">Ao responder aos prompts gerados pelo comando anterior, substitua as respostas padr?o das tr?s instru??es a seguir.</span><span class="sxs-lookup"><span data-stu-id="53241-109">When responding to the prompts that are generated by the previous command, override the default answers for the following 3 prompts.</span></span> <span data-ttu-id="53241-110">Para os demais prompts, voc? pode aceitar as respostas padr?o.</span><span class="sxs-lookup"><span data-stu-id="53241-110">You can accept the default answers for all other prompts.</span></span>

- <span data-ttu-id="53241-111">**Instalar o roteador vue?**</span><span class="sxs-lookup"><span data-stu-id="53241-111">**Install vue-router?**</span></span> `No`
- <span data-ttu-id="53241-112">**Configurar testes de unidades:** `No`</span><span class="sxs-lookup"><span data-stu-id="53241-112">**Set up unit tests:** `No`</span></span>
- <span data-ttu-id="53241-113">**Configurar testes e2e com Nightwatch?**</span><span class="sxs-lookup"><span data-stu-id="53241-113">**Setup e2e tests with Nightwatch?**</span></span> `No`

![Prompts da CLI do Vue](../images/vue-cli-prompts.png)

## <a name="generate-the-manifest-file"></a><span data-ttu-id="53241-115">Gerar o arquivo de manifesto.</span><span class="sxs-lookup"><span data-stu-id="53241-115">Generate the manifest file</span></span>

<span data-ttu-id="53241-116">Cada suplemento requer um arquivo de manifesto para definir os recursos e configura??es.</span><span class="sxs-lookup"><span data-stu-id="53241-116">Each add-in requires a manifest file to define its settings and capabilities.</span></span>

1. <span data-ttu-id="53241-117">Navegue at? a pasta do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="53241-117">Navigate to your app folder.</span></span>

    ```bash
    cd my-add-in
    ```

2. <span data-ttu-id="53241-118">Use o gerador do Yeoman para gerar o arquivo de manifesto para o seu suplemento.</span><span class="sxs-lookup"><span data-stu-id="53241-118">Use the Yeoman generator to generate the manifest file for your add-in.</span></span> <span data-ttu-id="53241-119">Execute o comando a seguir e responda aos prompts conforme mostrado abaixo.</span><span class="sxs-lookup"><span data-stu-id="53241-119">Run the following command and then answer the prompts as shown below.</span></span>

    ```bash
    yo office
    ```

    - <span data-ttu-id="53241-120">**Gostaria de criar uma nova subpasta para o seu projeto?:** `No`</span><span class="sxs-lookup"><span data-stu-id="53241-120">**Would you like to create a new subfolder for your project?:** `No`</span></span>
    - <span data-ttu-id="53241-121">**Como deseja nomear seu suplemento?** `My Office Add-in`</span><span class="sxs-lookup"><span data-stu-id="53241-121">**What do you want to name your add-in?:** `My Office Add-in`</span></span>
    - <span data-ttu-id="53241-122">**Para qual aplicativo cliente do Office voc? deseja suporte?:** `Excel`</span><span class="sxs-lookup"><span data-stu-id="53241-122">**Which Office client application would you like to support?:** `Excel`</span></span>
    - <span data-ttu-id="53241-123">**Gostaria de criar um novo suplemento?** `No`</span><span class="sxs-lookup"><span data-stu-id="53241-123">**Would you like to create a new add-in?:** `No`</span></span>

    <span data-ttu-id="53241-p104">O gerador perguntar? se voc? deseja abrir **resource.html**. N?o ? necess?rio abri-lo para este tutorial, mas fique ? vontade em fazer isso se tiver curiosidade. Escolha Sim ou N?o para concluir o assistente e deixar o gerador fazer seu trabalho.</span><span class="sxs-lookup"><span data-stu-id="53241-p104">The generator will then ask you if you want to open **resource.html**. It isn't necessary to open it for this tutorial, but feel free to open it if you're curious! Choose yes or no to complete the wizard and allow the generator to do its work.</span></span>

    ![Gerador do Yeoman](../images/yo-office.png)
    
    > [!NOTE]
    > <span data-ttu-id="53241-128">Se for solicitada a substitui??o de **package.json**, responda **N?o** (n?o substituir).</span><span class="sxs-lookup"><span data-stu-id="53241-128">If you're prompted to overwrite **package.json**, answer **No** (do not overwrite).</span></span>

## <a name="secure-the-app"></a><span data-ttu-id="53241-129">Proteger o aplicativo</span><span class="sxs-lookup"><span data-stu-id="53241-129">Secure the app</span></span>

[!include[HTTPS guidance](../includes/https-guidance.md)]

<span data-ttu-id="53241-130">Para ativar o HTTPS para o seu aplicativo, abra **package.json** na raiz do projeto, modifique o script `dev` para adicionar o sinalizador `--https` e salve o arquivo.</span><span class="sxs-lookup"><span data-stu-id="53241-130">To enable HTTPS for your app, open **package.json** in the root of the project, modify the `dev` script to add the `--https` flag, and save the file.</span></span>

```json
"dev": "webpack-dev-server --https --inline --progress --config build/webpack.dev.conf.js"
```

## <a name="update-the-app"></a><span data-ttu-id="53241-131">Atualizar o aplicativo</span><span class="sxs-lookup"><span data-stu-id="53241-131">Update the app</span></span>

1. <span data-ttu-id="53241-p105">No editor de c?digo, abra o arquivo de manifesto (o arquivo no diret?rio raiz do aplicativo com um nome que termina em "manifest.xml"). Substitua todas as ocorr?ncias de `https://localhost:3000` por `https://localhost:8080` e salve o arquivo.</span><span class="sxs-lookup"><span data-stu-id="53241-p105">In your code editor, open the manifest file (i.e., the file in the root directory of your app with a name ending in "manifest.xml"). Replace all occurrences of `https://localhost:3000` with `https://localhost:8080` and save the file.</span></span>

2. <span data-ttu-id="53241-134">Abra **index.html**, adicione a marca `<script>` a seguir imediatamente antes da marca `</head>` e salve o arquivo.</span><span class="sxs-lookup"><span data-stu-id="53241-134">Open **index.html**, add the following `<script>` tag immediately before the `</head>` tag, and save the file.</span></span>

    ```html
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    ```

3. <span data-ttu-id="53241-135">Abra **src/main.js** e *remova* o seguinte bloco de c?digo:</span><span class="sxs-lookup"><span data-stu-id="53241-135">Open **src/main.js** and *remove* the following block of code:</span></span>

    ```js
    new Vue({
        el: '#app',
        components: {App},
        template: '<App/>'
    })
    ```
    
    <span data-ttu-id="53241-136">Depois adicione o c?digo seguinte no mesmo local e salve o arquivo.</span><span class="sxs-lookup"><span data-stu-id="53241-136">Then add the following code in that same location, and save the file.</span></span> 
                                                         
    ```js
    const Office = window.Office
    Office.initialize = () => {
      new Vue({
        el: '#app',
        components: {App},
        template: '<App/>'
      })
    }
    ```

4. <span data-ttu-id="53241-137">Abra **src/App.vue**, substitua o conte?do do arquivo pelo c?digo a seguir, adicione uma quebra de linha ao final do arquivo (ou seja, ap?s a marca `</style>`) e salve o arquivo.</span><span class="sxs-lookup"><span data-stu-id="53241-137">Open **src/App.vue**, replace file contents with the following code, add a line break at the end of the file (i.e., after the `</style>` tag), and save the file.</span></span> 

    ```html
    <template>
    <div id="app">
        <div id="content">
        <div id="content-header">
            <div class="padding">
            <h1>Welcome</h1>
            </div>
        </div>
        <div id="content-main">
            <div class="padding">
            <p>Choose the button below to set the color of the selected range to green.</p>
            <br/>
            <h3>Try it out</h3>
            <button @click="onSetColor">Set color</button>
            </div>
        </div>
        </div>
    </div>
    </template>

    <script>
    export default {
      name: 'App',
      methods: {
        onSetColor () {
          window.Excel.run(async (context) => {
            const range = context.workbook.getSelectedRange()
            range.format.fill.color = 'green'
            await context.sync()
          })
        }
      }
    }
    </script>

    <style>
    #content-header {
        background: #2a8dd4;
        color: #fff;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 80px;
        overflow: hidden;
    }

    #content-main {
        background: #fff;
        position: fixed;
        top: 80px;
        left: 0;
        right: 0;
        bottom: 0;
        overflow: auto;
    }

    .padding {
        padding: 15px;
    }
    </style>
    ```

## <a name="start-the-dev-server"></a><span data-ttu-id="53241-138">Iniciar o servidor de desenvolvimento</span><span class="sxs-lookup"><span data-stu-id="53241-138">Start the dev server</span></span>

1. <span data-ttu-id="53241-139">No terminal, execute o comando a seguir para iniciar o servidor de desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="53241-139">From the terminal, run the following command to start the dev server.</span></span>

    ```bash
    npm start
    ```

2. <span data-ttu-id="53241-140">Em um navegador da web, acesse `https://localhost:8080`.</span><span class="sxs-lookup"><span data-stu-id="53241-140">In a web browser, navigate to `https://localhost:8080`.</span></span> <span data-ttu-id="53241-141">Se o navegador indicar que o certificado do site n?o ? confi?vel, configure o computador para confiar no certificado.</span><span class="sxs-lookup"><span data-stu-id="53241-141">If your browser indicates that the site's certificate is not trusted, you will need to configure your computer to trust the certificate.</span></span> 

3. <span data-ttu-id="53241-142">Depois que o navegador carregar a p?gina do suplemento sem erros de certificado, ser? poss?vel testar o suplemento.</span><span class="sxs-lookup"><span data-stu-id="53241-142">After your browser loads the add-in page without any certificate errors, you're ready test your add-in.</span></span> 

## <a name="try-it-out"></a><span data-ttu-id="53241-143">Experimente</span><span class="sxs-lookup"><span data-stu-id="53241-143">Try it out</span></span>

1. <span data-ttu-id="53241-144">Siga as instru??es da plataforma que voc? usar? para executar o suplemento e realizar sideload do suplemento no Excel.</span><span class="sxs-lookup"><span data-stu-id="53241-144">Follow the instructions for the platform you'll be using to run your add-in and sideload the add-in within Excel.</span></span>

    - <span data-ttu-id="53241-145">Windows: [Realizar sideload de Suplementos do Office no Windows](../testing/create-a-network-shared-folder-catalog-for-task-pane-and-content-add-ins.md)</span><span class="sxs-lookup"><span data-stu-id="53241-145">Windows: [Sideload Office Add-ins on Windows](../testing/create-a-network-shared-folder-catalog-for-task-pane-and-content-add-ins.md)</span></span>
    - <span data-ttu-id="53241-146">Excel Online: [Realizar sideload dos Suplementos do Office no Office Online](../testing/sideload-office-add-ins-for-testing.md#sideload-an-office-add-in-on-office-online)</span><span class="sxs-lookup"><span data-stu-id="53241-146">Excel Online: [Sideload Office Add-ins in Office Online](../testing/sideload-office-add-ins-for-testing.md#sideload-an-office-add-in-on-office-online)</span></span>
    - <span data-ttu-id="53241-147">iPad e Mac: [Realizar sideload dos Suplementos do Office no iPad e Mac](../testing/sideload-an-office-add-in-on-ipad-and-mac.md)</span><span class="sxs-lookup"><span data-stu-id="53241-147">iPad and Mac: [Sideload Office Add-ins on iPad and Mac](../testing/sideload-an-office-add-in-on-ipad-and-mac.md)</span></span>

2. <span data-ttu-id="53241-148">No Excel, escolha a guia **P?gina Inicial** e o bot?o **Mostrar Painel de Tarefas** na faixa de op??es para abrir o painel de tarefas do suplemento.</span><span class="sxs-lookup"><span data-stu-id="53241-148">In Excel, choose the **Home** tab, and then choose the **Show Taskpane** button in the ribbon to open the add-in task pane.</span></span>

    ![Bot?o do Suplemento do Excel](../images/excel-quickstart-addin-2a.png)

3. <span data-ttu-id="53241-150">Selecione um intervalo de c?lulas na planilha.</span><span class="sxs-lookup"><span data-stu-id="53241-150">Select any range of cells in the worksheet.</span></span>

4. <span data-ttu-id="53241-151">No painel de tarefas, escolha o bot?o **Definir cor** para definir a cor do intervalo selecionado como verde.</span><span class="sxs-lookup"><span data-stu-id="53241-151">In the task pane, choose the **Set color** button to set the color of the selected range to green.</span></span>

    ![Suplemento do Excel](../images/excel-quickstart-addin-2c.png)

## <a name="next-steps"></a><span data-ttu-id="53241-153">Pr?ximas etapas</span><span class="sxs-lookup"><span data-stu-id="53241-153">Next steps</span></span>

<span data-ttu-id="53241-p107">Voc? criou com ?xito um suplemento do Excel usando o Vue, parab?ns! Agora, saiba mais sobre os recursos dos suplementos do Excel e crie um mais complexo, acompanhando o tutorial de suplemento do Excel.</span><span class="sxs-lookup"><span data-stu-id="53241-p107">Congratulations, you've successfully created an Excel add-in using Vue! Next, learn more about the capabilities of an Excel add-in and build a more complex add-in by following along with the Excel add-in tutorial.</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="53241-156">Tutorial de suplemento do Excel</span><span class="sxs-lookup"><span data-stu-id="53241-156">Excel add-in tutorial</span></span>](../tutorials/excel-tutorial.yml)

## <a name="see-also"></a><span data-ttu-id="53241-157">Veja tamb?m</span><span class="sxs-lookup"><span data-stu-id="53241-157">See also</span></span>

* [<span data-ttu-id="53241-158">Tutorial de suplemento do Excel</span><span class="sxs-lookup"><span data-stu-id="53241-158">Excel add-in tutorial</span></span>](../tutorials/excel-tutorial-create-table.md)
* [<span data-ttu-id="53241-159">Principais conceitos da API JavaScript do Excel</span><span class="sxs-lookup"><span data-stu-id="53241-159">Excel JavaScript API core concepts</span></span>](../excel/excel-add-ins-core-concepts.md)
* [<span data-ttu-id="53241-160">Exemplos de c?digo do suplemento do Excel</span><span class="sxs-lookup"><span data-stu-id="53241-160">Excel add-in code samples</span></span>](http://dev.office.com/code-samples#?filters=excel,office%20add-ins)
* [<span data-ttu-id="53241-161">Refer?ncia da API JavaScript do Excel</span><span class="sxs-lookup"><span data-stu-id="53241-161">Excel JavaScript API reference</span></span>](https://dev.office.com/reference/add-ins/excel/excel-add-ins-reference-overview)