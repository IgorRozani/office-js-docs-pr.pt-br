---
title: Coautoria em suplementos do Excel
description: ''
ms.date: 12/04/2017
ms.openlocfilehash: d0ef481f9efd6b977963091d5d0a123c30a5a789
ms.sourcegitcommit: c72c35e8389c47a795afbac1b2bcf98c8e216d82
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/23/2018
---
# <a name="coauthoring-in-excel-add-ins"></a><span data-ttu-id="b2939-102">Coautoria em suplementos do Excel</span><span class="sxs-lookup"><span data-stu-id="b2939-102">Coauthoring in Excel add-ins</span></span>  

<span data-ttu-id="b2939-103">Com a [coautoria](https://support.office.com/en-US/article/Collaborate-on-Excel-workbooks-at-the-same-time-with-co-authoring-7152aa8b-b791-414c-a3bb-3024e46fb104), v?rias pessoas podem trabalhar juntas e editar simultaneamente a mesma pasta de trabalho do Excel.</span><span class="sxs-lookup"><span data-stu-id="b2939-103">With [coauthoring](https://support.office.com/en-US/article/Collaborate-on-Excel-workbooks-at-the-same-time-with-co-authoring-7152aa8b-b791-414c-a3bb-3024e46fb104), multiple people can work together and edit the same Excel workbook simultaneously.</span></span> <span data-ttu-id="b2939-104">Todos os coautores de uma pasta de trabalho podem ver as altera??es de outros coautores assim que o coautor salva a pasta de trabalho.</span><span class="sxs-lookup"><span data-stu-id="b2939-104">All coauthors of a workbook can see another coauthor's changes as soon as that coauthor saves the workbook.</span></span> <span data-ttu-id="b2939-105">Para ser coautor de uma pasta de trabalho do Excel, esta deve ser armazenada no OneDrive, OneDrive for Business ou SharePoint Online.</span><span class="sxs-lookup"><span data-stu-id="b2939-105">To coauthor an Excel workbook, the workbook must be stored in OneDrive, OneDrive for Business, or SharePoint Online.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b2939-106">No Excel 2016 para Office 365, voc? ver? o Salvamento Autom?tico no canto superior esquerdo.</span><span class="sxs-lookup"><span data-stu-id="b2939-106">In Excel 2016 for Office 365, you will notice AutoSave in the upper-left corner.</span></span> <span data-ttu-id="b2939-107">Quando o Salvamento Autom?tico estiver ativado, os coautores ver?o as respectivas altera??es em tempo real.</span><span class="sxs-lookup"><span data-stu-id="b2939-107">When AutoSave is turned on, coauthors see your changes in real time.</span></span> <span data-ttu-id="b2939-108">Considere o impacto desse comportamento no design do seu suplemento do Excel.</span><span class="sxs-lookup"><span data-stu-id="b2939-108">Consider the impact of this behavior on the design of your Excel add-in.</span></span> <span data-ttu-id="b2939-109">Os usu?rios podem desativar o Salvamento Autom?tico pelo bot?o no canto superior esquerdo da janela do Excel.</span><span class="sxs-lookup"><span data-stu-id="b2939-109">Users can turn off AutoSave via the switch in the upper left of the Excel window.</span></span>

<span data-ttu-id="b2939-110">A coautoria est? dispon?vel nas seguintes plataformas:</span><span class="sxs-lookup"><span data-stu-id="b2939-110">Coauthoring is available on the following platforms:</span></span>

- <span data-ttu-id="b2939-111">Excel Online</span><span class="sxs-lookup"><span data-stu-id="b2939-111">Excel Online</span></span>
- <span data-ttu-id="b2939-112">Excel para Android</span><span class="sxs-lookup"><span data-stu-id="b2939-112">Excel for Android</span></span>
- <span data-ttu-id="b2939-113">Excel para iOS</span><span class="sxs-lookup"><span data-stu-id="b2939-113">Excel for iOS</span></span>
- <span data-ttu-id="b2939-114">Excel Mobile para Windows 10</span><span class="sxs-lookup"><span data-stu-id="b2939-114">Excel Mobile for Windows 10</span></span>
- <span data-ttu-id="b2939-115">Excel para Windows Desktop para clientes do Office 365 (compila??o 16.0.8326.2076 ou posterior do Windows Desktop, que est? dispon?vel para clientes do canal atual em vigor desde agosto de 2017)</span><span class="sxs-lookup"><span data-stu-id="b2939-115">Excel for Windows Desktop for Office 365 customers (Windows desktop build 16.0.8326.2076 or later, which is available to current channel customers effective August 2017)</span></span>

## <a name="coauthoring-overview"></a><span data-ttu-id="b2939-116">Vis?o geral da coautoria</span><span class="sxs-lookup"><span data-stu-id="b2939-116">Coauthoring overview</span></span>
 
<span data-ttu-id="b2939-117">Quando voc? altera o conte?do de uma pasta de trabalho, o Excel sincroniza automaticamente essas altera??es entre todos os coautores.</span><span class="sxs-lookup"><span data-stu-id="b2939-117">When you change a workbook's content, Excel automatically synchronizes those changes across all coauthors.</span></span> <span data-ttu-id="b2939-118">Os coautores podem alterar o conte?do de uma pasta de trabalho, assim como o c?digo em execu??o em um suplemento do Excel.</span><span class="sxs-lookup"><span data-stu-id="b2939-118">Coauthors can change the content of a workbook, but so can code running within an Excel add-in.</span></span> <span data-ttu-id="b2939-119">Por exemplo, quando o seguinte c?digo JavaScript ? executado em um suplemento do Office, o valor de um intervalo ? definido como Contoso:</span><span class="sxs-lookup"><span data-stu-id="b2939-119">For example, when the following JavaScript code runs in an Office add-in, the value of a range is set to Contoso:</span></span>

```js
range.values = [['Contoso']];
```
<span data-ttu-id="b2939-120">Depois que "Contoso" ? sincronizado entre todos os coautores, qualquer usu?rio ou suplemento em execu??o na mesma pasta de trabalho ver? o novo valor do intervalo.</span><span class="sxs-lookup"><span data-stu-id="b2939-120">After 'Contoso' synchronizes across all coauthors, any user or add-in running in the same workbook will see the new value of the range.</span></span> 

<span data-ttu-id="b2939-121">A coautoria sincroniza apenas o conte?do dentro da pasta de trabalho compartilhada.</span><span class="sxs-lookup"><span data-stu-id="b2939-121">Coauthoring only synchronizes the content within the shared workbook.</span></span> <span data-ttu-id="b2939-122">Os valores copiados da pasta de trabalho em vari?veis de JavaScript em um suplemento do Excel n?o s?o sincronizados.</span><span class="sxs-lookup"><span data-stu-id="b2939-122">Values copied from the workbook to JavaScript variables in an Excel add-in are not synchronized.</span></span> <span data-ttu-id="b2939-123">Por exemplo, se seu suplemento armazenar o valor de uma c?lula (como "Contoso") em uma vari?vel de JavaScript e um coautor alterar o valor da c?lula para "Exemplo", ap?s a sincroniza??o todos os coautores ver?o "Exemplo" na c?lula.</span><span class="sxs-lookup"><span data-stu-id="b2939-123">For example, if your add-in stores the value of a cell (such as 'Contoso') in a JavaScript variable, and then a coauthor changes the value of the cell to 'Example', after synchronization all coauthors see 'Example' in the cell.</span></span> <span data-ttu-id="b2939-124">No entanto, o valor da vari?vel de JavaScript continuar? definido como "Contoso".</span><span class="sxs-lookup"><span data-stu-id="b2939-124">However, the value of the JavaScript variable is still set to 'Contoso'.</span></span> <span data-ttu-id="b2939-125">Al?m disso, quando v?rios autores usarem o mesmo suplemento, cada coautor ter? sua pr?pria c?pia da vari?vel, que n?o ? sincronizada.</span><span class="sxs-lookup"><span data-stu-id="b2939-125">Furthermore, when multiple coauthors use the same add-in, each coauthor has their own copy of the variable, which is not synchronized.</span></span> <span data-ttu-id="b2939-126">Quando voc? usar vari?veis que usam o conte?do da pasta de trabalho, n?o se esque?a de verificar se h? valores atualizados na pasta de trabalho antes de usar a vari?vel.</span><span class="sxs-lookup"><span data-stu-id="b2939-126">When you use variables that use workbook content, be sure you check for updated values in the workbook before you use the variable.</span></span> 

## <a name="use-events-to-manage-the-in-memory-state-of-your-add-in"></a><span data-ttu-id="b2939-127">Usar eventos para gerenciar o estado na mem?ria do suplemento</span><span class="sxs-lookup"><span data-stu-id="b2939-127">Use events to manage the in-memory state of your add-in</span></span>
 
<span data-ttu-id="b2939-128">Os suplementos do Excel podem ler conte?do da pasta de trabalho (de planilhas ocultas e um objeto de configura??o) e armazen?-lo em estruturas de dados, como vari?veis.</span><span class="sxs-lookup"><span data-stu-id="b2939-128">Excel add-ins can read workbook content (from hidden worksheets and a setting object), and then store it in data structures such as variables.</span></span> <span data-ttu-id="b2939-129">Depois que os valores originais s?o copiados em qualquer uma dessas estruturas de dados, os coautores podem atualizar o conte?do da pasta de trabalho original.</span><span class="sxs-lookup"><span data-stu-id="b2939-129">After the original values are copied into any of these data structures, coauthors can update the original workbook content.</span></span> <span data-ttu-id="b2939-130">Isso significa que os valores copiados nas estruturas de dados agora est?o fora de sincronia com o conte?do da pasta de trabalho.</span><span class="sxs-lookup"><span data-stu-id="b2939-130">This means that the copied values in the data structures are now out of sync with the workbook content.</span></span> <span data-ttu-id="b2939-131">Ao criar seus suplementos, lembre-se dessa separa??o do conte?do da pasta de trabalho e dos valores armazenados em estruturas de dados.</span><span class="sxs-lookup"><span data-stu-id="b2939-131">When you build your add-ins, be sure to account for this separation of workbook content and values stored in data structures.</span></span>

<span data-ttu-id="b2939-132">Por exemplo, voc? pode criar um suplemento de conte?do que exibe visualiza??es personalizadas.</span><span class="sxs-lookup"><span data-stu-id="b2939-132">For example, you might build a content add-in that displays custom visualizations.</span></span> <span data-ttu-id="b2939-133">O estado de suas visualiza??es personalizadas pode ser salvo em uma planilha oculta.</span><span class="sxs-lookup"><span data-stu-id="b2939-133">The state of your custom visualizations might be saved in a hidden worksheet.</span></span> <span data-ttu-id="b2939-134">Quando coautores usarem a mesma pasta de trabalho, o seguinte cen?rio poder? ocorrer:</span><span class="sxs-lookup"><span data-stu-id="b2939-134">When coauthors use the same workbook, the following scenario can occur:</span></span>

- <span data-ttu-id="b2939-135">O Usu?rio A abre o documento e as visualiza??es personalizadas s?o mostradas na pasta de trabalho.</span><span class="sxs-lookup"><span data-stu-id="b2939-135">User A opens the document and the custom visualizations are shown in the workbook.</span></span> <span data-ttu-id="b2939-136">As visualiza??es personalizadas leem dados de uma planilha oculta (por exemplo, a cor das visualiza??es ? definida como azul).</span><span class="sxs-lookup"><span data-stu-id="b2939-136">The custom visualizations read data from a hidden worksheet (for example, the color of the visualizations is set to blue).</span></span>
- <span data-ttu-id="b2939-137">O usu?rio B abre o mesmo documento e come?a a modificar as visualiza??es personalizadas.</span><span class="sxs-lookup"><span data-stu-id="b2939-137">User B opens the same document, and starts modifying the custom visualizations.</span></span> <span data-ttu-id="b2939-138">O usu?rio B define a cor das visualiza??es personalizadas para laranja.</span><span class="sxs-lookup"><span data-stu-id="b2939-138">User B sets the color of the custom visualizations to orange.</span></span> <span data-ttu-id="b2939-139">A cor laranja ? salva para a planilha oculta.</span><span class="sxs-lookup"><span data-stu-id="b2939-139">Orange is saved to the hidden worksheet.</span></span>
- <span data-ttu-id="b2939-140">A planilha oculta do Usu?rio A ? atualizada com o novo valor laranja.</span><span class="sxs-lookup"><span data-stu-id="b2939-140">User A's hidden worksheet is updated with the new value of orange.</span></span>
- <span data-ttu-id="b2939-141">As visualiza??es personalizadas do Usu?rio A continuam azuis.</span><span class="sxs-lookup"><span data-stu-id="b2939-141">User A's custom visualizations are still blue.</span></span> 

<span data-ttu-id="b2939-142">Se quiser que as visualiza??es personalizadas do Usu?rio A respondam ?s altera??es feitas pelos coautores na planilha oculta, use o evento [BindingDataChanged](https://dev.office.com/reference/add-ins/shared/binding.bindingdatachangedevent).</span><span class="sxs-lookup"><span data-stu-id="b2939-142">If you want User A's custom visualizations to respond to changes made by coauthors on the hidden worksheet, use the [BindingDataChanged](https://dev.office.com/reference/add-ins/shared/binding.bindingdatachangedevent) event.</span></span> <span data-ttu-id="b2939-143">Isso garante que as altera??es no conte?do da pasta de trabalho feitas pelos coautores sejam refletidas no estado do seu suplemento.</span><span class="sxs-lookup"><span data-stu-id="b2939-143">This ensures that changes to workbook content made by coauthors is reflected in the state of your add-in.</span></span>

## <a name="caveats-to-using-events-with-coauthoring"></a><span data-ttu-id="b2939-144">Advert?ncias para usar eventos com coautoria</span><span class="sxs-lookup"><span data-stu-id="b2939-144">Caveats to using events with coauthoring</span></span> 

<span data-ttu-id="b2939-145">Conforme descrito anteriormente, em alguns cen?rios, acionar eventos para todos os coautores proporciona uma experi?ncia do usu?rios aprimorada.</span><span class="sxs-lookup"><span data-stu-id="b2939-145">As described earlier, in some scenarios, triggering events for all coauthors provides an improved user experience.</span></span> <span data-ttu-id="b2939-146">No entanto, lembre-se de que, em alguns cen?rios, esse comportamento pode resultar em uma m? experi?ncia do usu?rio.</span><span class="sxs-lookup"><span data-stu-id="b2939-146">However, be aware that in some scenarios this behavior can produce poor user experiences.</span></span> 

<span data-ttu-id="b2939-147">Por exemplo, em cen?rios de valida??o de dados, ? comum exibir a interface do usu?rio em resposta a eventos.</span><span class="sxs-lookup"><span data-stu-id="b2939-147">For example, in data validation scenarios, it is common to display UI in response to events.</span></span> <span data-ttu-id="b2939-148">O evento [BindingDataChanged](https://dev.office.com/reference/add-ins/shared/binding.bindingdatachangedevent) descrito na se??o anterior ? executado quando um usu?rio local ou coautor (remoto) altera o conte?do da pasta de trabalho na associa??o.</span><span class="sxs-lookup"><span data-stu-id="b2939-148">The [BindingDataChanged](https://dev.office.com/reference/add-ins/shared/binding.bindingdatachangedevent) event described in the previous section runs when either a local user or coauthor (remote) changes the workbook content within the binding.</span></span> <span data-ttu-id="b2939-149">Se o manipulador de eventos do evento **BindingDataChanged** exibir a interface do usu?rio, os usu?rios ver?o a interface do usu?rio que n?o est? relacionada ?s altera??es em que eles estavam trabalhando na pasta de trabalho, levando a uma m? experi?ncia do usu?rio.</span><span class="sxs-lookup"><span data-stu-id="b2939-149">If the event handler of the **BindingDataChanged** event displays UI, users will see UI that is unrelated to changes they were working on in the workbook, leading to a poor user experience.</span></span> <span data-ttu-id="b2939-150">Evite a exibi??o da interface do usu?rio ao usar eventos no suplemento.</span><span class="sxs-lookup"><span data-stu-id="b2939-150">Avoid displaying UI when using events in your add-in.</span></span>

## <a name="see-also"></a><span data-ttu-id="b2939-151">Veja tamb?m</span><span class="sxs-lookup"><span data-stu-id="b2939-151">See also</span></span> 

- [<span data-ttu-id="b2939-152">Sobre a coautoria no Excel (VBA)</span><span class="sxs-lookup"><span data-stu-id="b2939-152">About coauthoring in Excel (VBA)</span></span>](https://msdn.microsoft.com/en-us/vba/excel-vba/articles/about-coauthoring-in-excel) 
- [<span data-ttu-id="b2939-153">Como o Salvamento Autom?tico afeta suplementos e macros (VBA)</span><span class="sxs-lookup"><span data-stu-id="b2939-153">How AutoSave impacts add-ins and macros (VBA)</span></span>](https://msdn.microsoft.com/en-us/vba/office-shared-vba/articles/how-autosave-impacts-addins-and-macros) 
