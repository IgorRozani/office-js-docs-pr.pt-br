---
title: Autorizar servi?os externos no seu suplemento do Office
description: ''
ms.date: 12/04/2017
ms.openlocfilehash: 34e8119d4ecf6432cde7f06552584d164b8c9b8e
ms.sourcegitcommit: c72c35e8389c47a795afbac1b2bcf98c8e216d82
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/23/2018
---
# <a name="authorize-external-services-in-your-office-add-in"></a><span data-ttu-id="a3dd5-102">Autorizar servi?os externos no seu suplemento do Office</span><span class="sxs-lookup"><span data-stu-id="a3dd5-102">Authorize external services in your Office Add-in</span></span>

<span data-ttu-id="a3dd5-p101">Servi?os online populares, incluindo o Office 365, o Google, o Facebook, o LinkedIn, o SalesForce e o GitHub, permitem que os desenvolvedores forne?am acesso para os usu?rios a suas contas em outros aplicativos, o que possibilita que voc? inclua esses servi?os no seu Suplemento do Office.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-p101">Popular online services, including Office 365, Google, Facebook, LinkedIn, SalesForce, and GitHub, let developers give users access to their accounts in other applications. This gives you the ability to include these services in your Office Add-in.</span></span>

<span data-ttu-id="a3dd5-p102">A estrutura padr?o do setor para habilitar o acesso de aplicativos Web a um servi?o online ? **OAuth 2.0**. Na maioria das situa??es, voc? n?o precisa saber os detalhes de como a estrutura funciona para us?-la no seu suplemento. Est?o dispon?veis muitas bibliotecas que simplificam os detalhes para voc?.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-p102">The industry standard framework for enabling web application access to an online service is **OAuth 2.0**. In most situations, you don't need to know the details of how the framework works to use it in your add-in. Many libraries are available that simplify the details for you.</span></span>

<span data-ttu-id="a3dd5-p103">Uma ideia fundamental do OAuth ? que um aplicativo pode ser uma entidade de seguran?a por si s?, assim como um usu?rio ou um grupo, com sua pr?pria identidade e conjunto de permiss?es. Nos cen?rios mais comuns, quando o usu?rio realiza uma a??o no suplemento do Office que requer o servi?o online, o suplemento envia ao servi?o uma solicita??o para um conjunto espec?fico de permiss?es para a conta do usu?rio. Em seguida, o servi?o solicita que o usu?rio conceda essas permiss?es ao suplemento. Ap?s a concess?o das permiss?es, o servi?o envia ao suplemento um pequeno *token de acesso* codificado. O suplemento pode usar o servi?o, incluindo o token, em todas as suas solicita??es para as APIs do servi?o. Por?m, o suplemento s? pode agir dentro das permiss?es concedidas a ele pelo usu?rio. O token tamb?m expira ap?s um tempo especificado.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-p103">A fundamental idea of OAuth is that an application can be a security principal unto itself, just like a user or a group, with its own identity and set of permissions. In the most typical scenarios, when the user takes an action in the Office add-in that requires the online service, the add-in sends the service a request for a specific set of permissions to the user's account. The service then prompts the user to grant the add-in those permissions. After the permissions are granted, the service sends the add-in a small encoded *access token*. The add-in can use the service by including the token in all its requests to the service's APIs. But the add-in can act only within the permissions that the user granted it. The token also expires after a specified time.</span></span>

<span data-ttu-id="a3dd5-115">V?rios padr?es OAuth, chamados de *fluxos* ou *tipos de concess?o*, foram projetados para diferentes cen?rios.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-115">Several OAuth patterns, called *flows* or *grant types*, are designed for different scenarios.</span></span> <span data-ttu-id="a3dd5-116">Os dois padr?es a seguir s?o os mais comumente implementados:</span><span class="sxs-lookup"><span data-stu-id="a3dd5-116">The following two patterns are the most commonly implemented:</span></span>

- <span data-ttu-id="a3dd5-117">**Fluxo Impl?cito**: a comunica??o entre o suplemento e o servi?o online ? implementada com um JavaScript no lado do cliente.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-117">**Implicit flow**: Communication between the add-in and the online service is implemented with client-side JavaScript.</span></span>
- <span data-ttu-id="a3dd5-p105">**Fluxo de C?digo de Autoriza??o**: a comunica??o ? *de servidor para servidor* entre o aplicativo Web do seu suplemento e o servi?o online. Portanto, a implementa??o ? feita com c?digo no lado do servidor.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-p105">**Authorization Code flow**: Communication is *server-to-server* between your add-in's web application and the online service. So, it is implemented with server-side code.</span></span>

<span data-ttu-id="a3dd5-p106">A finalidade dos fluxos do OAuth ? proteger a identidade e a autoriza??o do aplicativo. No fluxo de C?digo de Autoriza??o, voc? recebe um *segredo de cliente* que precisa permanecer oculto. Como um Aplicativo de P?gina ?nica (SPA) n?o tem como proteger o segredo, recomendamos que voc? use o fluxo Impl?cito em SPAs.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-p106">The purpose of an OAuth flow is to secure the identity and authorization of the application. In the Authorization Code flow, you're provided a *client secret* that needs to be kept hidden. A Single Page Application (SPA) has no way to protect the secret, so we recommend that you use the Implicit flow in SPAs.</span></span>

<span data-ttu-id="a3dd5-123">Voc? deve estar familiarizado com os pr?s e os contras do fluxo impl?cito e o fluxo do C?digo de Autoriza??o.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-123">You should be familiar with the pros and cons of the Implicit flow and the Authorization Code flow.</span></span> <span data-ttu-id="a3dd5-124">Para obter mais informa??es sobre esses dois fluxos, consulte [C?digo de Autoriza??o](https://tools.ietf.org/html/rfc6749#section-1.3.1) e [Impl?cito](https://tools.ietf.org/html/rfc6749#section-1.3.2).</span><span class="sxs-lookup"><span data-stu-id="a3dd5-124">For more infomation about these two flows, see [Authorization Code](https://tools.ietf.org/html/rfc6749#section-1.3.1) and [Implicit](https://tools.ietf.org/html/rfc6749#section-1.3.2).</span></span>

> [!NOTE]
> <span data-ttu-id="a3dd5-125">Voc? tamb?m tem a op??o de usar um servi?o intermedi?rio para executar a autoriza??o e passar o token de acesso ao seu suplemento.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-125">You also have the option of using a middleman service to perform authorization and pass the access token to your add-in.</span></span> <span data-ttu-id="a3dd5-126">Confira detalhes sobre esse cen?rio na se??o **Servi?os intermedi?rios** mais adiante neste artigo.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-126">For details about this scenario, see the **Middleman services** section later in this article.</span></span>

## <a name="authorization-to-microsoft-graph"></a><span data-ttu-id="a3dd5-127">Autoriza??o para o Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="a3dd5-127">Authorization to Microsoft Graph</span></span>

<span data-ttu-id="a3dd5-128">Se o servi?o externo puder ser acessado por meio do Microsoft Graph, como o Office 365 ou o OneDrive, voc? poder? fornecer a melhor experi?ncia para os usu?rios e a experi?ncia de desenvolvimento mais f?cil para voc?, usando o sistema de logon ?nico descrito em [Autorizar para o Microsoft Graph no suplemento do Office](authorize-to-microsoft-graph.md) e seus artigos relacionados.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-128">If the external service is accessible through Microsoft Graph, such as Office 365 or OneDrive, then you can provide the best experience for your users, and the easiest development experience for yourself, by using the single sign-on system described at [Enable single sign-on for Office Add-ins](authorize-to-microsoft-graph.md) and its related articles.</span></span> <span data-ttu-id="a3dd5-129">As t?cnicas descritas neste artigo s?o ideais para servi?os externos que n?o podem ser acessados com o Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-129">The techniques described in this article are best used for external services that are not accessible with Microsoft Graph.</span></span> <span data-ttu-id="a3dd5-130">No entanto, elas *podem* ser usadas para acessar o Microsoft Graph, e voc? pode preferir as vantagens do logon ?nico.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-130">However, they *can* be used to access Microsoft Graph, and you might prefer them to the advantages of single sign-on.</span></span> <span data-ttu-id="a3dd5-131">Por exemplo, o sistema de logon ?nico requer c?digo do lado do servidor, portanto, ele n?o pode ser usado com um aplicativo de p?gina ?nica.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-131">For example, the single sign-on system requires server-side code, so it cannot be used with a true single page app.</span></span> <span data-ttu-id="a3dd5-132">Al?m disso, o sistema de logon ?nico ainda n?o ? compat?vel com todas as plataformas.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-132">Also, the single sign-on system is not yet supported on all platforms.</span></span>

## <a name="using-the-implicit-flow-in-office-add-ins"></a><span data-ttu-id="a3dd5-133">Usando o fluxo Impl?cito em suplementos do Office</span><span class="sxs-lookup"><span data-stu-id="a3dd5-133">Using the Implicit flow in Office Add-ins</span></span>
<span data-ttu-id="a3dd5-134">A melhor maneira de descobrir se um servi?o online suporta o fluxo impl?cito ? consultar a documenta??o do servi?o.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-134">The best way to find out if an online service supports the Implicit flow is to consult the service's documentation.</span></span> <span data-ttu-id="a3dd5-135">Para servi?os que suportam o fluxo impl?cito, voc? pode usar a biblioteca de JavaScript **Office-js-helpers** para fazer todo o trabalho detalhado para voc?:</span><span class="sxs-lookup"><span data-stu-id="a3dd5-135">For services that support the Implicit flow, you can use the **Office-js-helpers** JavaScript library to do all the detailed work for you:</span></span>

- [<span data-ttu-id="a3dd5-136">Office-js-helpers</span><span class="sxs-lookup"><span data-stu-id="a3dd5-136">Office-js-helpers</span></span>](https://github.com/OfficeDev/office-js-helpers)

<span data-ttu-id="a3dd5-137">Para obter informa??es sobre outras bibliotecas que suportam o fluxo impl?cito, consulte a se??o **Bibliotecas** mais adiante neste artigo.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-137">For information about other libraries that support the Implicit flow, see the **Libraries** section later in this article.</span></span>

## <a name="using-the-authorization-code-flow-in-office-add-ins"></a><span data-ttu-id="a3dd5-138">Usando o fluxo de C?digo de Autoriza??o em suplementos do Office</span><span class="sxs-lookup"><span data-stu-id="a3dd5-138">Using the Authorization Code flow in Office Add-ins</span></span>

<span data-ttu-id="a3dd5-p111">Muitas bibliotecas est?o dispon?veis para implementar o fluxo de C?digo de Autoriza??o em v?rias linguagens e estruturas. Para mais informa??es sobre algumas dessas bibliotecas, consulte a se??o **Bibliotecas** mais adiante neste artigo.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-p111">Many libraries are available for implementing the Authorization Code flow in various languages and frameworks. For more information about some of these libraries, see the **Libraries** section later in this article.</span></span>

<span data-ttu-id="a3dd5-141">As seguintes amostras fornecem exemplos de suplementos que implementam o Fluxo do C?digo de Autoriza??o:</span><span class="sxs-lookup"><span data-stu-id="a3dd5-141">The following samples provide examples of add-ins that implement the Authorization Code flow:</span></span>

- <span data-ttu-id="a3dd5-142">[Office-Add-in-Nodejs-ServerAuth](https://github.com/OfficeDev/Office-Add-in-Nodejs-ServerAuth) (NodeJS)</span><span class="sxs-lookup"><span data-stu-id="a3dd5-142">[Office-Add-in-Nodejs-ServerAuth](https://github.com/OfficeDev/Office-Add-in-Nodejs-ServerAuth) (NodeJS)</span></span>
- <span data-ttu-id="a3dd5-143">[PowerPoint-Add-in-Microsoft-Graph-ASPNET-InsertChart](https://github.com/OfficeDev/PowerPoint-Add-in-Microsoft-Graph-ASPNET-InsertChart) (ASP.NET MVC)</span><span class="sxs-lookup"><span data-stu-id="a3dd5-143">[PowerPoint-Add-in-Microsoft-Graph-ASPNET-InsertChart](https://github.com/OfficeDev/PowerPoint-Add-in-Microsoft-Graph-ASPNET-InsertChart) (ASP.NET MVC)</span></span>

### <a name="relayproxy-functions"></a><span data-ttu-id="a3dd5-144">Fun??es de retransmiss?o/Proxy</span><span class="sxs-lookup"><span data-stu-id="a3dd5-144">Relay/Proxy functions</span></span>

<span data-ttu-id="a3dd5-p112">Voc? pode usar o fluxo do C?digo de Autoriza??o mesmo com um aplicativo Web sem servidor armazenando os valores de **ID do cliente** e **segredo cliente** em uma fun??o simples hospedada em um servi?o como o [Azure Functions](https://azure.microsoft.com/en-us/services/functions) ou o [Amazon Lambda](https://aws.amazon.com/lambda). A fun??o troca um c?digo espec?fico por um **token de acesso** e transmite-o de volta para o cliente. A seguran?a dessa abordagem depende do quanto protegido ? o acesso ? fun??o.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-p112">You can use the Authorization Code flow even with a serverless web application by storing the **client ID** and **client secret** values in a simple function that is hosted in a service such as [Azure Functions](https://azure.microsoft.com/en-us/services/functions) or [Amazon Lambda](https://aws.amazon.com/lambda). The function exchanges a given code for an **access token** and relays it back to the client. The security of this approach depends on how well access to the function is guarded.</span></span>

<span data-ttu-id="a3dd5-p113">Para usar essa t?cnica, o suplemento exibe uma interface do usu?rio/pop-up para mostrar a tela de logon do servi?o online (Google, Facebook e assim por diante). Quando o usu?rio se conecta e concede ao suplemento a permiss?o para acessar seus recursos no servi?o online, o suplemento recebe um c?digo que ent?o pode ser enviado para a fun??o online. Os servi?os descritos em **Servi?os intermedi?rios** neste artigo usam um fluxo semelhante a esse.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-p113">To use this technique, your add-in displays a UI/popup to show the login screen for the online service (Google, Facebook, and so on). When the user signs in and grants the add-in permission to her resources in the online service, the add-in receives a code which can be then sent to the online function. The services described in the **Middleman services** section later in this article use a similar flow.</span></span>

## <a name="libraries"></a><span data-ttu-id="a3dd5-151">Bibliotecas</span><span class="sxs-lookup"><span data-stu-id="a3dd5-151">Libraries</span></span>

<span data-ttu-id="a3dd5-152">As bibliotecas est?o dispon?veis para v?rios idiomas e plataformas, tanto para o fluxo impl?cito quanto para o fluxo do C?digo de Autoriza??o.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-152">Libraries are available for many languages and platforms, for both the Implicit flow and the Authorization Code flow.</span></span> <span data-ttu-id="a3dd5-153">Algumas bibliotecas s?o de prop?sito geral, enquanto outras s?o para servi?os online espec?ficos.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-153">Some libraries are general purpose, while others are for specific online services.</span></span>

<span data-ttu-id="a3dd5-p115">**Office 365 e outros servi?os que usam o Azure Active Directory como provedor de autoriza??o**: [Bibliotecas de autentica??o do Active Directory do Azure](https://azure.microsoft.com/en-us/documentation/articles/active-directory-authentication-libraries/). Tamb?m est? dispon?vel uma visualiza??o da [Biblioteca de Autentica??o da Microsoft](https://www.nuget.org/packages/Microsoft.Identity.Client).</span><span class="sxs-lookup"><span data-stu-id="a3dd5-p115">**Office 365 and other services that use Azure Active Directory as the authorization provider**: [Azure Active Directory Authentication Libraries](https://azure.microsoft.com/en-us/documentation/articles/active-directory-authentication-libraries/). A preview is also available for the [Microsoft Authentication Library](https://www.nuget.org/packages/Microsoft.Identity.Client).</span></span>

<span data-ttu-id="a3dd5-p116">**Google**: Pesquise "auth" ou o nome da sua linguagem no [GitHub.com/Google](https://github.com/google). A maioria dos reposit?rios relevantes se chama `google-auth-library-[name of language]`.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-p116">**Google**: Search [GitHub.com/Google](https://github.com/google) for "auth" or the name of your language. Most of the relevant repos are named `google-auth-library-[name of language]`.</span></span>

<span data-ttu-id="a3dd5-158">**Facebook**: Pesquise "library" ou "sdk" no [Facebook para Desenvolvedores](https://developers.facebook.com).</span><span class="sxs-lookup"><span data-stu-id="a3dd5-158">**Facebook**: Search [Facebook for Developers](https://developers.facebook.com) for "library" or "sdk".</span></span>

<span data-ttu-id="a3dd5-p117">**OAuth 2.0 Geral**: Uma p?gina de links para bibliotecas de mais de uma d?zia de linguagens ? mantida pelo IETF OAuth Working Group, em: [C?digo OAuth](http://oauth.net/code/). Observe que algumas dessas bibliotecas s?o para implementar um servi?o compat?vel com o OAuth. As bibliotecas interessantes para voc?, como desenvolvedor do suplemento, s?o chamadas de bibliotecas de *cliente* nesta p?gina, pois o servidor Web ? um cliente do servi?o compat?vel com o OAuth.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-p117">**General OAuth 2.0**: A page of links to libraries for over a dozen languages is maintained by the IETF OAuth Working Group at: [OAuth Code](http://oauth.net/code/). Note that some of these libraries are for implementing an OAuth compliant service. The libraries of interest to you as a an add-in developer are called *client* libraries on this page because your web server is a client of the OAuth compliant service.</span></span>

## <a name="middleman-services"></a><span data-ttu-id="a3dd5-162">Servi?os intermedi?rios</span><span class="sxs-lookup"><span data-stu-id="a3dd5-162">Middleman services</span></span>

<span data-ttu-id="a3dd5-p118">Seu suplemento pode usar um servi?o intermedi?rio, como o OAuth.io ou o Auth0, para executar a autoriza??o. O servi?o intermedi?rio fornece tokens de acesso para servi?os online populares ou simplifica o processo de habilitar o logon social para esse suplemento. Com muito pouco c?digo, o suplemento pode usar qualquer script no lado do cliente ou c?digo no lado do servidor para se conectar ao servi?o intermedi?rio e enviar ao suplemento qualquer token necess?rio para o servi?o online. Todo o c?digo de implementa??o de autoriza??o est? no servi?o intermedi?rio.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-p118">Your add-in can use a middleman service such as OAuth.io or Auth0 to perform authorization. A middleman service may either provide access tokens for popular online services or simplify the process of enabling social login for your add-in, or both. With very little code, your add-in can use either client-side script or server-side code to connect to the middleman service and it will send your add-in any required tokens for the online service. All of the authorization implementation code is in the middleman service.</span></span>

<span data-ttu-id="a3dd5-167">Para obter exemplos de suplementos que usam um servi?o intermedi?rio para autoriza??o, consulte as seguintes amostras:</span><span class="sxs-lookup"><span data-stu-id="a3dd5-167">For examples of add-ins that use a middleman service for authorization, see the following samples:</span></span>

- <span data-ttu-id="a3dd5-168">[Office-Add-in-Auth0](https://github.com/OfficeDev/Office-Add-in-Auth0) usa o Auth0 para habilitar o login social com o Facebook, Google e contas da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-168">[Office-Add-in-Auth0](https://github.com/OfficeDev/Office-Add-in-Auth0) uses Auth0 to enable social login with Facebook, Google, and Microsoft Accounts.</span></span>

- <span data-ttu-id="a3dd5-169">[Office-Add-in-OAuth.io](https://github.com/OfficeDev/Office-Add-in-OAuth.io) usa o OAuth.io para obter tokens de acesso a partir do Facebook e Google.</span><span class="sxs-lookup"><span data-stu-id="a3dd5-169">[Office-Add-in-OAuth.io](https://github.com/OfficeDev/Office-Add-in-OAuth.io) uses OAuth.io to get access tokens from Facebook and Google.</span></span>

## <a name="what-is-cors"></a><span data-ttu-id="a3dd5-170">O que ? CORS?</span><span class="sxs-lookup"><span data-stu-id="a3dd5-170">What is CORS?</span></span>

<span data-ttu-id="a3dd5-p119">CORS significa [Compartilhamento de Recursos Entre Origens](https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS). Para obter informa??es sobre como usar o CORS nos suplementos, confira [Como lidar com as limita??es da pol?tica de mesma origem nos suplementos do Office](addressing-same-origin-policy-limitations.md).</span><span class="sxs-lookup"><span data-stu-id="a3dd5-p119">CORS stands for [Cross Origin Resource Sharing](https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS). For information about how to use CORS inside add-ins, see [Addressing same-origin policy limitations in Office Add-ins](addressing-same-origin-policy-limitations.md).</span></span>
