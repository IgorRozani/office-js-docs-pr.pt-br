---
title: Solicitar permissões para uso da API em suplementos do painel de tarefas e conteúdo
description: ''
ms.date: 12/04/2017
ms.openlocfilehash: 2105dab859cdfa114c4b6f3c9eeaa73d3ae49ce8
ms.sourcegitcommit: c53f05bbd4abdfe1ee2e42fdd4f82b318b363ad7
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/12/2018
ms.locfileid: "25505304"
---
# <a name="requesting-permissions-for-api-use-in-content-and-task-pane-add-ins"></a><span data-ttu-id="524d1-102">Solicitar permissões para uso da API em suplementos do painel de tarefas e conteúdo</span><span class="sxs-lookup"><span data-stu-id="524d1-102">Requesting permissions for API use in content and task pane add-ins</span></span>

<span data-ttu-id="524d1-103">Este artigo descreve os diferentes níveis de permissão que você pode declarar no manifesto do suplemento de conteúdo ou de painel de tarefas para especificar o nível de acesso à API JavaScript que o suplemento requer para seus recursos.</span><span class="sxs-lookup"><span data-stu-id="524d1-103">This article describes the different permission levels that you can declare in your content or task pane add-in's manifest to specify the level of JavaScript API access your add-in requires for its features.</span></span> 




## <a name="permissions-model"></a><span data-ttu-id="524d1-104">Modelo de permissões</span><span class="sxs-lookup"><span data-stu-id="524d1-104">Permissions model</span></span>


<span data-ttu-id="524d1-105">Um modelo de permissões de acesso da API JavaScript de cinco níveis fornece a base para a privacidade e a segurança para os usuários dos seus complementos de conteúdo e de painel de tarefas. A Figura 1 mostra os cinco níveis de permissões de API que você pode declarar no manifesto do seu suplemento.</span><span class="sxs-lookup"><span data-stu-id="524d1-105">A five-level JavaScript API access-permissions model provides the basis for privacy and security for users of your content and task pane add-ins. Figure 1 shows the five levels of API permissions you can declare in your add-in's manifest.</span></span>


<span data-ttu-id="524d1-106">*Figura 1. Modelo de permissão de cinco níveis para suplementos de conteúdo e de painel de  tarefas*</span><span class="sxs-lookup"><span data-stu-id="524d1-106">*Figure 1. The five-level permission model for content and task pane add-ins*</span></span>

![Níveis de permissões para aplicativos do painel de tarefas](../images/office15-app-sdk-task-pane-app-permission.png)



<span data-ttu-id="524d1-p101">Essas permissões especificam o subconjunto da API que o tempo de execução do suplemento permitirá que o suplemento de conteúdo ou de painel de tarefas use quando um usuário inserir e ativar o suplemento (confiar nele). Para declarar o nível de permissão que o suplemento do conteúdo ou do painel de tarefas requer, especifique um dos valores de texto da permissão no elemento [Permissions](https://docs.microsoft.com/office/dev/add-ins/reference/manifest/permissions?view=office-js) do manifesto do suplemento. O exemplo a seguir solicita a permissão  **WriteDocument**, que autorizará somente os métodos que podem gravar no documento, mas não lê-lo.</span><span class="sxs-lookup"><span data-stu-id="524d1-p101">These permissions specify the subset of the API that the add-in runtime will allow your content or task pane add-in to use when a user inserts, and then activates (trusts) your add-in. To declare the permission level your content or task pane add-in requires, specify one of the permission text values in the [Permissions](https://docs.microsoft.com/office/dev/add-ins/reference/manifest/permissions?view=office-js) element of your add-in's manifest. The following example requests the **WriteDocument** permission, which will allow only methods that can write to (but not read) the document.</span></span>




```XML
<Permissions>WriteDocument</Permissions>
```

<span data-ttu-id="524d1-p102">Como prática recomendada, você deve solicitar permissões com base no princípio do _menor privilégio_. Ou seja, você deve solicitar permissão para acessar apenas o subconjunto mínimo da API que o suplemento requer para funcionar corretamente. Por exemplo, se o suplemento precisar apenas ler os dados no documento de um usuário para seus recursos, você não deve solicitar mais do que a permissão **ReadDocument**.</span><span class="sxs-lookup"><span data-stu-id="524d1-p102">As a best practice, you should request permissions based on the principle of  _least privilege_. That is, you should request permission to access only the minimum subset of the API that your add-in requires to function correctly. For example, if your add-in needs only to read data in a user's document for its features, you should request no more than the **ReadDocument** permission.</span></span>

<span data-ttu-id="524d1-114">A tabela a seguir descreve o subconjunto da API JavaScript que é habilitado por cada nível de permissão.</span><span class="sxs-lookup"><span data-stu-id="524d1-114">The following table describes the subset of the JavaScript API that is enabled by each permission level.</span></span>



|<span data-ttu-id="524d1-115">**Permissão**</span><span class="sxs-lookup"><span data-stu-id="524d1-115">**Permission**</span></span>|<span data-ttu-id="524d1-116">**Subconjunto habilitado da API**</span><span class="sxs-lookup"><span data-stu-id="524d1-116">**Enabled subset of the API**</span></span>|
|:-----|:-----|
|<span data-ttu-id="524d1-117">**Restrito**</span><span class="sxs-lookup"><span data-stu-id="524d1-117">**Restricted**</span></span>|<span data-ttu-id="524d1-118">Os métodos do objeto [Settings](https://docs.microsoft.com/javascript/api/office/office.settings?view=office-js) e o método [Document.getActiveViewAsync](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#getactiveviewasync-options--callback-). Esse é o nível mínimo de permissão que pode ser solicitado por um suplemento de conteúdo ou de painel de tarefas.</span><span class="sxs-lookup"><span data-stu-id="524d1-118">The methods of the [Settings](https://docs.microsoft.com/javascript/api/office/office.settings?view=office-js) object, and the [Document.getActiveViewAsync](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#getactiveviewasync-options--callback-) method.This is the minimum permission level that can be requested by a content or task pane add-in.</span></span>|
|<span data-ttu-id="524d1-119">**ReadDocument**</span><span class="sxs-lookup"><span data-stu-id="524d1-119">**ReadDocument**</span></span>|<span data-ttu-id="524d1-120">Além da API autorizada pela permissão **Restricted**, adiciona acesso aos membros da API necessários para ler o documento e gerenciar associações. Isso inclui o uso de:</span><span class="sxs-lookup"><span data-stu-id="524d1-120">In addition to the API allowed by the  **Restricted** permission, adds access to the API members necessary to read the document and manage bindings.This includes the use of:</span></span><br/><ul><li><span data-ttu-id="524d1-121">O método <a href="https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#getselecteddataasync-coerciontype--options--callback-" target="_blank">Document.getSelectedDataAsync</a> para obter o texto selecionado, HTML (Word apenas) ou dados tabulares, mas não o código do Open Office XML (OOXML) subjacente que contém todos os dados no documento.</span><span class="sxs-lookup"><span data-stu-id="524d1-121">The <a href="https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#getselecteddataasync-coerciontype--options--callback-" target="_blank">Document.getSelectedDataAsync</a> method to get the selected text, HTML (Word only), or tabular data, but not the underlying Open Office XML (OOXML) code that contains all of the data in the document.</span></span></p></li><li><p><span data-ttu-id="524d1-122">O método <a href="https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#getfileasync-filetype--options--callback-" target="_blank">Document.getFileAsync</a> para acessar todo o texto no documento, mas não a cópia binária OOXML subjacente do documento.</span><span class="sxs-lookup"><span data-stu-id="524d1-122">The <a href="https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#getfileasync-filetype--options--callback-" target="_blank">Document.getFileAsync</a> method to get all of the text in the document, but not the underlying OOXML binary copy of the document.</span></span></p></li><li><p><span data-ttu-id="524d1-123">O método <a href="https://docs.microsoft.com/javascript/api/office/office.binding?view=office-js#getdataasync-options--callback-" target="_blank">Binding.getDataAsync</a> para a leitura dos dados vinculados no documento.</span><span class="sxs-lookup"><span data-stu-id="524d1-123">The <a href="https://docs.microsoft.com/javascript/api/office/office.binding?view=office-js#getdataasync-options--callback-" target="_blank">Binding.getDataAsync</a> method for reading bound data in the document.</span></span></p></li><li><p><span data-ttu-id="524d1-124">Os métodos <a href="https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js#addfromnameditemasync-itemname--bindingtype--options--callback-" target="_blank">addFromNamedItemAsync</a>, <a href="https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js#addfrompromptasync-bindingtype--options--callback-" target="_blank">addFromPromptAsync</a>e <a href="https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js#addfromselectionasync-bindingtype--options--callback-" target="_blank">addFromSelectionAsync</a> do objeto <span class="keyword">Bindings</span> para criar associações no documento.</span><span class="sxs-lookup"><span data-stu-id="524d1-124">The <a href="https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js#addfromnameditemasync-itemname--bindingtype--options--callback-" target="_blank">addFromNamedItemAsync</a>, <a href="https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js#addfrompromptasync-bindingtype--options--callback-" target="_blank">addFromPromptAsync</a>, <a href="https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js#addfromselectionasync-bindingtype--options--callback-" target="_blank">addFromSelectionAsync</a> methods of the <span class="keyword">Bindings</span> object for creating bindings in the document.</span></span></p></li><li><p><span data-ttu-id="524d1-125">Os métodos <a href="https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js#getallasync-options--callback-" target="_blank">getAllAsync</a>, <a href="https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js#getbyidasync-id--options--callback-" target="_blank">getByIdAsync</a> e <a href="https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js#releasebyidasync-id--options--callback-" target="_blank">releaseByIdAsync</a> do objeto <span class="keyword">Bindings</span> para acessar e remover as associações no documento.</span><span class="sxs-lookup"><span data-stu-id="524d1-125">The <a href="https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js#getallasync-options--callback-" target="_blank">getAllAsync</a>, <a href="https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js#getbyidasync-id--options--callback-" target="_blank">getByIdAsync</a>, and <a href="https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js#releasebyidasync-id--options--callback-" target="_blank">releaseByIdAsync</a> methods of the <span class="keyword">Bindings</span> object for accessing and removing bindings in the document.</span></span></p></li><li><p><span data-ttu-id="524d1-126">O método <a href="https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#getfilepropertiesasync-options--callback-" target="_blank">Document.getFilePropertiesAsync</a> para acessar as propriedades de arquivo do documento, como a URL do documento.</span><span class="sxs-lookup"><span data-stu-id="524d1-126">The <a href="https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#getfilepropertiesasync-options--callback-" target="_blank">Document.getFilePropertiesAsync</a> method to access document file properties, such as the URL of the document.</span></span></p></li><li><p><span data-ttu-id="524d1-127">O método <a href="https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#gotobyidasync-id--gototype--options--callback-" target="_blank">Document.goToByIdAsync</a> para navegar até os objetos nomeados e locais no documento.</span><span class="sxs-lookup"><span data-stu-id="524d1-127">The <a href="https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#gotobyidasync-id--gototype--options--callback-" target="_blank">Document.goToByIdAsync</a> method to navigate to named objects and locations in the document.</span></span></p></li><li><p><span data-ttu-id="524d1-128">Para os suplementos do painel de tarefas do Project, todos os métodos "get" do objeto <a href="https://docs.microsoft.com/javascript/api/office/office.document?view=office-js" target="_blank">ProjectDocument</a>.</span><span class="sxs-lookup"><span data-stu-id="524d1-128">For task pane add-ins for Project, all of the "get" methods of the <a href="https://docs.microsoft.com/javascript/api/office/office.document?view=office-js" target="_blank">ProjectDocument</a> object.</span></span> </p></li></ul>|
|<span data-ttu-id="524d1-129">**ReadAllDocument**</span><span class="sxs-lookup"><span data-stu-id="524d1-129">**ReadAllDocument**</span></span>|<span data-ttu-id="524d1-130">Além da API autorizada pelas permissões **Restricted** e **ReadDocument**, permite os seguintes acessos adicionais aos dados do documento:</span><span class="sxs-lookup"><span data-stu-id="524d1-130">In addition to the API allowed by the  **Restricted** and **ReadDocument** permissions, allows the following additional access to document data:</span></span><br/><ul><li><p><span data-ttu-id="524d1-131">Os métodos <span class="keyword">Document.getSelectedDataAsync</span> e <span class="keyword">Document.getFileAsync</span> podem acessar o código OOXML subjacente do documento (que, além de texto, pode conter formatação, links, gráficos incorporados, comentários, revisões, etc.).</span><span class="sxs-lookup"><span data-stu-id="524d1-131">The <span class="keyword">Document.getSelectedDataAsync</span> and <span class="keyword">Document.getFileAsync</span> methods can access the underlying OOXML code of the document (which in addition to the text may include formatting, links, embedded graphics, comments, revisions, and so forth).</span></span></p></li></ul>|
|<span data-ttu-id="524d1-132">**WriteDocument**</span><span class="sxs-lookup"><span data-stu-id="524d1-132">**WriteDocument**</span></span>|<span data-ttu-id="524d1-133">Além da API autorizada pela permissão **Restricted**, adiciona acesso aos seguintes membros da API:</span><span class="sxs-lookup"><span data-stu-id="524d1-133">In addition to the API allowed by the  **Restricted** permission, adds access to the following API members:</span></span><br/><ul><li><p><span data-ttu-id="524d1-134">O método <a href="https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#setselecteddataasync-data--options--callback-" target="_blank">Document.setSelectedDataAsync</a> para gravar na seleção do usuário no documento.</span><span class="sxs-lookup"><span data-stu-id="524d1-134">The <a href="https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#setselecteddataasync-data--options--callback-" target="_blank">Document.setSelectedDataAsync</a> method to write to the user's selection in the document.</span></span></p></li></ul>|
|<span data-ttu-id="524d1-135">**ReadWriteDocument**</span><span class="sxs-lookup"><span data-stu-id="524d1-135">**ReadWriteDocument**</span></span>|<span data-ttu-id="524d1-136">Além da API autorizada pelas permissões **Restricted**, **ReadDocument**, **ReadAllDocument** e **WriteDocument**, contém acesso a todas as APIs remanescentes compatíveis com suplementos de painel de tarefas e de conteúdo, incluindo métodos para se inscrever em eventos. Você precisa declarar a permissão **ReadWriteDocument** para acessar esses membros adicionais da API:</span><span class="sxs-lookup"><span data-stu-id="524d1-136">In addition to the API allowed by the  **Restricted**,  **ReadDocument**,  **ReadAllDocument**, and  **WriteDocument** permissions, includes access to all remaining API supported by content and task pane add-ins, including methods for subscribing to events.You must declare the  **ReadWriteDocument** permission to access these additional API members:</span></span><br/><ul><li><p><span data-ttu-id="524d1-137">O método <a href="https://docs.microsoft.com/javascript/api/office/office.binding?view=office-js#setdataasync-data--options--callback-" target="_blank">Binding.setDataAsync</a> para gravar nas regiões associadas do documento.</span><span class="sxs-lookup"><span data-stu-id="524d1-137">The <a href="https://docs.microsoft.com/javascript/api/office/office.binding?view=office-js#setdataasync-data--options--callback-" target="_blank">Binding.setDataAsync</a> method for writing to bound regions of the document.</span></span></p></li><li><p><span data-ttu-id="524d1-138">O método <a href="https://docs.microsoft.com/javascript/api/office/office.tablebinding?view=office-js#addrowsasync-rows--options--callback-" target="_blank">TableBinding.addRowsAsync</a> para adicionar linhas às tabelas associadas.</span><span class="sxs-lookup"><span data-stu-id="524d1-138">The <a href="https://docs.microsoft.com/javascript/api/office/office.tablebinding?view=office-js#addrowsasync-rows--options--callback-" target="_blank">TableBinding.addRowsAsync</a> method for adding rows to bound tables.</span></span></p></li><li><p><span data-ttu-id="524d1-139">O método <a href="https://docs.microsoft.com/javascript/api/office/office.tablebinding?view=office-js#addcolumnsasync-tabledata--options--callback-" target="_blank">TableBinding.addColumnsAsync</a> para adicionar colunas às tabelas associadas.</span><span class="sxs-lookup"><span data-stu-id="524d1-139">The <a href="https://docs.microsoft.com/javascript/api/office/office.tablebinding?view=office-js#addcolumnsasync-tabledata--options--callback-" target="_blank">TableBinding.addColumnsAsync</a> method for adding columns to bound tables.</span></span></p></li><li><p><span data-ttu-id="524d1-140">O método <a href="https://docs.microsoft.com/javascript/api/office/office.tablebinding?view=office-js#deletealldatavaluesasync-options--callback-" target="_blank">TableBinding.deleteAllDataValuesAsync</a> para excluir todos os dados em uma tabela associada.</span><span class="sxs-lookup"><span data-stu-id="524d1-140">The <a href="https://docs.microsoft.com/javascript/api/office/office.tablebinding?view=office-js#deletealldatavaluesasync-options--callback-" target="_blank">TableBinding.deleteAllDataValuesAsync</a> method for deleting all data in a bound table.</span></span></p></li><li><p><span data-ttu-id="524d1-141">Os métodos <a href="https://docs.microsoft.com/javascript/api/office/office.tablebinding?view=office-js#setformatsasync-cellformat--options--callback-" target="_blank">setFormatsAsync</a>, <a href="https://docs.microsoft.com/javascript/api/office/office.tablebinding?view=office-js#clearformatsasync-options--callback-" target="_blank">clearFormatsAsync</a> e <a href="https://docs.microsoft.com/javascript/api/office/office.tablebinding?view=office-js#settableoptionsasync-tableoptions--options--callback-" target="_blank">setTableOptionsAsync</a> do objeto <span class="keyword">TableBinding</span> para definir a formatação e as opções nas tabelas associadas.</span><span class="sxs-lookup"><span data-stu-id="524d1-141">The <a href="https://docs.microsoft.com/javascript/api/office/office.tablebinding?view=office-js#setformatsasync-cellformat--options--callback-" target="_blank">setFormatsAsync</a>, <a href="https://docs.microsoft.com/javascript/api/office/office.tablebinding?view=office-js#clearformatsasync-options--callback-" target="_blank">clearFormatsAsync</a>, and <a href="https://docs.microsoft.com/javascript/api/office/office.tablebinding?view=office-js#settableoptionsasync-tableoptions--options--callback-" target="_blank">setTableOptionsAsync</a> methods of the <span class="keyword">TableBinding</span> object for setting formatting and options on bound tables.</span></span></p></li><li><p><span data-ttu-id="524d1-142">Todos os membros dos objetos <a href="https://docs.microsoft.com/javascript/api/office/office.customxmlnode?view=office-js" target="_blank">CustomXmlNode</a>, <a href="https://docs.microsoft.com/javascript/api/office/office.customxmlpart?view=office-js" target="_blank">CustomXmlPart</a>, <a href="https://docs.microsoft.com/javascript/api/office/office.customxmlparts?view=office-js" target="_blank">CustomXmlParts</a> e <a href="https://docs.microsoft.com/javascript/api/office/office.customxmlprefixmappings?view=office-js" target="_blank">CustomXmlPrefixMappings</a>.</span><span class="sxs-lookup"><span data-stu-id="524d1-142">All of the members of the <a href="https://docs.microsoft.com/javascript/api/office/office.customxmlnode?view=office-js" target="_blank">CustomXmlNode</a>, <a href="https://docs.microsoft.com/javascript/api/office/office.customxmlpart?view=office-js" target="_blank">CustomXmlPart</a>, <a href="https://docs.microsoft.com/javascript/api/office/office.customxmlparts?view=office-js" target="_blank">CustomXmlParts</a>, and <a href="https://docs.microsoft.com/javascript/api/office/office.customxmlprefixmappings?view=office-js" target="_blank">CustomXmlPrefixMappings</a> objects.</span></span></p></li><li><p><span data-ttu-id="524d1-143">Todos os métodos para se inscrever em eventos compatíveis com suplementos de conteúdo e de painel de tarefas, especificamente os métodos <span class="keyword">addHandlerAsync</span> e <span class="keyword">removeHandlerAsync</span> dos objetos <a href="https://docs.microsoft.com/javascript/api/office/office.binding?view=office-js" target="_blank">Binding</a>, <a href="https://docs.microsoft.com/javascript/api/office/office.customxmlpart?view=office-js" target="_blank">CustomXmlPart</a>, <a href="https://docs.microsoft.com/javascript/api/office/office.document?view=office-js" target="_blank">Document</a>, <a href="https://docs.microsoft.com/javascript/api/office/office.document?view=office-js" target="_blank">ProjectDocument</a> e <a href="https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#settings" target="_blank">Settings</a>.</span><span class="sxs-lookup"><span data-stu-id="524d1-143">All of the methods for subscribing to the events supported by content and task pane add-ins, specifically the <span class="keyword">addHandlerAsync</span> and <span class="keyword">removeHandlerAsync</span> methods of the <a href="https://docs.microsoft.com/javascript/api/office/office.binding?view=office-js" target="_blank">Binding</a>, <a href="https://docs.microsoft.com/javascript/api/office/office.customxmlpart?view=office-js" target="_blank">CustomXmlPart</a>, <a href="https://docs.microsoft.com/javascript/api/office/office.document?view=office-js" target="_blank">Document</a>, <a href="https://docs.microsoft.com/javascript/api/office/office.document?view=office-js" target="_blank">ProjectDocument</a>, and <a href="https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#settings" target="_blank">Settings</a> objects.</span></span></p></li></ul>|

## <a name="see-also"></a><span data-ttu-id="524d1-144">Confira também</span><span class="sxs-lookup"><span data-stu-id="524d1-144">See also</span></span>

- [<span data-ttu-id="524d1-145">Privacidade e segurança para suplementos do Office</span><span class="sxs-lookup"><span data-stu-id="524d1-145">Privacy and security for Office Add-ins</span></span>](../concepts/privacy-and-security.md)
    


